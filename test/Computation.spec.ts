import { checkFloat, checkFloatArray} from './common';
import { MathUtils, SiderealTime } from '../src';
import 'mocha';
import { FrameConversions, FrameCenter, FrameOrientation } from '../src/Frames';
import { TimeFormat, TimeStamp } from '../src/TimeStamp';
import { StateVector } from '../src/StateVector';
import { TimeConvention } from '../src/TimeCorrelation';
import {AssertionError, strict as assert} from 'assert';
import { NutationData, Nutation } from '../src/Nutation';
import { EarthPosition, Wgs84 } from '../src/Wgs84';
import { EopParams, SolarParams } from '../src/EopParams';
import { TimeParametersInfo, TimeParameters, GregorianUnits, TimeParamsMode } from '../src/Configuration/TimeParameterConf';
import { CorrectionInfo, CorrectionType, RefractionModel, RefractionParams } from '../src/Configuration/CorrectionConf';
import { ObserverInfo, Observer } from '../src';
import { Target } from '../src';
import { ComputationInfo } from '../src/Configuration/ComputationConf';
import { targetList, targetMap } from '../src/Configuration/TargetConf';
import { Computation } from '../src/Computation';
import { TimeStepResults, TargetResults, PostProcessing, ObserverTable } from '../src/Results';
import { GregorianTime } from '../src/GregorianTime';

function checkOsv(val : StateVector, exp : StateVector, posTol : number, velTol : number) {
    assert.equal(val.frameCenter, exp.frameCenter);
    assert.equal(val.frameOrientation, exp.frameOrientation);
    assert.equal(val.timeStamp, exp.timeStamp);
    checkFloatArray(val.position, exp.position, MathUtils.norm(val.position) * posTol);
    checkFloatArray(val.velocity, exp.velocity, MathUtils.norm(val.velocity) * velTol);
}

function testPlanet(refData : number[][], indTarget : number) {
    const targets : string[] = [
        "Sun     ",
        "Mercury ",
        "Venus   ",
        "Earth   ",
        "Moon    ",
        "Mars    ",
        "Jupiter ",
        "Saturn  ",
        "Uranus  ",
        "Neptune ",
        "Pluto   "
    ];
    const targetName : string = targets[indTarget];
    const startTime : GregorianTime = new GregorianTime(1980, 1, 2, 0, 0, 0);
    const endTime   : GregorianTime = new GregorianTime(2020, 1, 2, 0, 0, 0);

    let timeParameters : TimeParametersInfo = TimeParameters.createFromGregorianSpan(
        startTime, endTime, 1, GregorianUnits.YEAR, TimeConvention.TIME_UTC
    );

    timeParameters = TimeParameters.convertToList(timeParameters);
    timeParameters = TimeParameters.convertToJulianList(timeParameters);

    const corrections : CorrectionInfo = {
        corrections : [CorrectionType.LIGHT_TIME],
        refractionParams : {refractionModel : RefractionModel.NO_CORRECTION}
    };
    const earthPos : EarthPosition = {lat : 61.4945763, lon : 23.8283, h : 121.916};
    const dummyTimeStamp : TimeStamp = new TimeStamp(
        TimeFormat.FORMAT_JULIAN, 
        TimeConvention.TIME_TDB,
        2458849.5000000);

    const observer : ObserverInfo = Observer.initializeFromWgs84(earthPos, dummyTimeStamp);
    const targetSel : Target[] = [targetList[indTarget]];

    const computationInfo : ComputationInfo = {
        timeParameters : timeParameters,
        corrections : corrections,
        observer : observer,
        targetList : targetSel
    };

    const computation : Computation = new Computation(computationInfo);

    const results : TimeStepResults[] = computation.compute();

    let sum = [0, 0, 0, 0, 0, 0];
    let max = [0, 0, 0, 0, 0, 0];

    for (let timeStep = 0; timeStep < results.length; timeStep++) {
        const timeStepResults : TimeStepResults = results[timeStep];
        const dataExp : number[] = refData[timeStep];
        const raAstrometricExp = dataExp[0];
        const declAstrometricExp = dataExp[1];
        const raApparentExp = dataExp[2];
        const declApparentExp = dataExp[3];
        const azExp = dataExp[4];
        const elExp = dataExp[5];
        
        for (let indTarget = 0; indTarget < timeStepResults.targets.length; indTarget++) {
            const observerTable : ObserverTable = (<ObserverTable[]> timeStepResults.observerTables)[indTarget];
            const jt : number = (<number[]>timeParameters.listJulian)[timeStep];
            const eopParams : EopParams = timeStepResults.eopParams;

            const raErr     : number = (3600000 * Math.abs(raAstrometricExp - observerTable.raDeclAstrometric[0]));
            const declErr   : number = (3600000 * Math.abs(declAstrometricExp - observerTable.raDeclAstrometric[1]));
            const raAppErr  : number = (3600000 * Math.abs(raApparentExp - observerTable.raDeclApparent[0]));
            const declAppErr: number = (3600000 * Math.abs(declApparentExp - observerTable.raDeclApparent[1]));
            const azErr     : number = (3600000 * Math.abs(azExp - observerTable.azElApparent[0]));
            const elErr     : number = (3600000 * Math.abs(elExp - observerTable.azElApparent[1]));

            if (isNaN(observerTable.azElApparent[0])) {
                console.log(timeStepResults.results[0].stateMapAberrationCla.get(FrameCenter.PLANET_TOPO));
                console.log(observerTable);
            }
            //console.log(raErr + " " + declErr + " " + raAppErr + " " + declAppErr + " " + azErr + " " + elErr + " " + observerTable.elongationSot);

            /*assert.equal(raErr < 150, true);
            assert.equal(declErr < 150, true);
            assert.equal(raErr < 150, true);
            assert.equal(declErr < 150, true);
            assert.equal(azErr < 1000, true);
            assert.equal(elErr < 300, true);*/

            sum = [sum[0] + raErr, sum[1] + declErr, sum[2] + raAppErr, sum[3] + declAppErr, sum[4] + azErr, sum[5] + elErr];
            max = [
                Math.max(max[0], raErr), Math.max(max[1], declErr),
                Math.max(max[2], raAppErr), Math.max(max[3], declAppErr),
                Math.max(max[4], azErr), Math.max(max[5], elErr),
            ];
        }
    }
    //console.log([sum[0] / results.length, sum[1] / results.length, sum[2] / results.length, 
    //             sum[3] / results.length, sum[4] / results.length, sum[5] / results.length]);
    const foo = " RA_astr " + (sum[0] / results.length).toFixed(1) + "(" + max[0].toFixed(1) + ")"
    + " DE_astr " + (sum[1] / results.length).toFixed(1) + "(" + max[1].toFixed(1) + ")"
    + " RA_app " + (sum[2] / results.length).toFixed(1) + "(" + max[2].toFixed(1) + ")"
    + " DE_app " + (sum[3] / results.length).toFixed(1) + "(" + max[3].toFixed(1) + ")"
    + " AZ_app " + (sum[4] / results.length).toFixed(1) + "(" + max[4].toFixed(1) + ")"
    + " EL_app " + (sum[5] / results.length).toFixed(1) + "(" + max[5].toFixed(1) + ")";

    console.log(targetName + foo);
}

describe('Computation', function() {
    describe('SSIE Targets', function() {

    it('Mercury', function() {
        const mercuryData : number[][] = [
            [ 269.752241384, -24.130274402, 269.437555543, -24.127001891,   48.805868653, -45.655879242], 
            [ 284.011739698, -24.669585147, 283.710773422, -24.694000905,   31.714856091, -50.363674830], 
            [ 296.706007183, -23.338459550, 296.425827902, -23.384088909,   12.874422968, -51.423330758], 
            [ 303.000690826, -20.810206360, 302.742110065, -20.863509586,    3.087075262, -49.341267841], 
            [ 277.479310010, -20.391310428, 277.230593079, -20.403775335,   37.397591257, -44.700186995], 
            [ 258.294773769, -20.939632943, 258.061497121, -20.923154401,   60.678857276, -38.017361360], 
            [ 264.047787671, -23.174568135, 263.826341677, -23.167925487,   55.405966541, -42.466131876], 
            [ 275.433303958, -24.602857585, 275.226299802, -24.612075371,   42.289603756, -47.976305840], 
            [ 288.332623894, -24.452831250, 288.144441130, -24.476664831,   24.493627177, -51.302657595], 
            [ 301.520441930, -22.155000670, 301.354804416, -22.189642401,    5.960839246, -50.593740866], 
            [ 297.464593150, -20.242708208, 297.316082135, -20.270311201,   11.179707085, -48.408987588], 
            [ 263.694322636, -20.201750139, 263.559374905, -20.197303167,   53.829104424, -39.742613857], 
            [ 258.558982363, -21.721299942, 258.438433749, -21.712685945,   60.003506801, -39.161518555], 
            [ 269.081991063, -23.984424748, 268.974061664, -23.983197662,   50.282588624, -45.049381448], 
            [ 281.405297354, -24.734987534, 281.311676660, -24.740351001,   34.802339784, -49.816100027], 
            [ 294.276937720, -23.754568662, 294.198877240, -23.764501036,   16.003209569, -51.551926213], 
            [ 302.809636649, -21.294614430, 302.746863013, -21.305319309,    2.898541630, -49.786502053], 
            [ 282.593283281, -20.330877670, 282.542825980, -20.332327234,   31.664954553, -45.841181852], 
            [ 258.405402352, -20.594710005, 258.368907598, -20.589461604,   60.013136543, -37.904782515], 
            [ 262.073929417, -22.780214273, 262.050075901, -22.776762157,   57.002700629, -41.466032426], 
            [ 272.941766725, -24.456225135, 272.931153174, -24.454791476,   44.904986736, -47.122651525], 
            [ 287.501677090, -24.494608181, 287.505607189, -24.493414096,   26.581254199, -51.016006196], 
            [ 299.576460290, -22.693999616, 299.595384825, -22.690567500,    8.357265724, -50.998063123], 
            [ 300.471014428, -20.414332367, 300.504757515, -20.408539701,    6.467832649, -48.791677354], 
            [ 267.788246582, -20.242819759, 267.838040608, -20.245182071,   48.821716194, -41.439283784], 
            [ 258.683484797, -21.520660815, 258.750184865, -21.527656566,   60.453806758, -38.780577501], 
            [ 266.804581983, -23.689075421, 266.889340694, -23.693101982,   52.384926411, -44.063534851], 
            [ 278.818626333, -24.735075197, 278.920896990, -24.731632056,   37.776161637, -49.174931203], 
            [ 291.759357631, -24.105634082, 291.877076948, -24.091522823,   19.239153042, -51.561110193], 
            [ 303.150636506, -21.422985509, 303.280865967, -21.397264577,    3.344618069, -49.870450912], 
            [ 288.980511162, -20.329299895, 289.126991852, -20.311994793,   22.731309865, -47.288618667], 
            [ 259.337826902, -20.335617180, 259.500515140, -20.346861500,   58.515593648, -38.209192679], 
            [ 260.279035414, -22.356128828, 260.459107220, -22.366416720,   58.357333383, -40.513450825], 
            [ 272.201356990, -24.340391014, 272.398790345, -24.335844650,   46.540934015, -46.541331862], 
            [ 284.882867613, -24.653463073, 285.093374195, -24.631391205,   29.804777628, -50.637425657], 
            [ 297.390044564, -23.189011357, 297.608850547, -23.148920122,   11.119099773, -51.305807073], 
            [ 302.015262509, -20.731795039, 302.242213959, -20.683360339,    3.810051520, -49.146534303], 
            [ 272.064284987, -20.282783524, 272.309016929, -20.276829565,   44.579124753, -42.728033196], 
            [ 257.881783992, -21.100954890, 258.141315823, -21.119127780,   60.715701030, -38.221861899], 
            [ 264.624086929, -23.347169717, 264.902413263, -23.355145291,   54.300694407, -43.053671623], 
            [ 276.264274204, -24.672491470, 276.559874425, -24.660035045,   40.614495861, -48.441240532]
        ];

        testPlanet(mercuryData, 1);
    });
        
    it('Venus', function() {
        const venusData : number[][] = [
            [ 315.919559177, -18.663493761, 315.629307858, -18.743685790,  344.765737386, -46.552737633], 
            [ 257.749423461, -22.142209044, 257.454687044, -22.116937747,   61.975923235, -38.842084656], 
            [ 311.084456230, -16.283125273, 310.821974519, -16.350339473,  352.312098440, -44.673700361], 
            [ 297.773829222, -22.295474454, 297.510760551, -22.341022968,   10.773508027, -50.515496159], 
            [ 239.671351802, -18.334145457, 239.431653468, -18.287791316,   76.944675031, -27.751889322], 
            [ 330.416875740, -13.705881154, 330.207359098, -13.781890447,  328.349849110, -39.056247927], 
            [ 277.935005841, -23.612425458, 277.712870813, -23.625407869,   38.914172039, -47.746461119], 
            [ 233.739741706, -15.476767854, 233.551504108, -15.434742854,   81.070897119, -22.383053103], 
            [ 316.423348250, -18.527533655, 316.250124774, -18.578888139,  344.038012378, -46.317844983], 
            [ 258.325288911, -22.226392885, 258.155915637, -22.215814489,   61.359640628, -39.196730058], 
            [ 308.149800159, -16.744532298, 308.006784830, -16.780673912,  356.184921656, -45.241539457], 
            [ 298.367883096, -22.214910900, 298.233430788, -22.239889048,    9.815574517, -50.470341599], 
            [ 240.093449279, -18.460690950, 239.978323043, -18.438871966,   76.579994110, -28.106008362], 
            [ 330.595706869, -13.606293981, 330.502077307, -13.639779820,  328.126609984, -38.862666241], 
            [ 278.558110503, -23.613879432, 278.465190466, -23.617554101,   38.026108997, -47.942312205], 
            [ 233.404492715, -15.460598139, 233.333961857, -15.442432609,   81.334413080, -22.255107568], 
            [ 316.926167866, -18.390182920, 316.866321021, -18.405636345,  343.324091866, -46.072248912], 
            [ 258.906124499, -22.308531082, 258.855793152, -22.302286316,   60.726691819, -39.541020408], 
            [ 304.942261856, -17.208286906, 304.906621206, -17.213917964,    0.482214450, -45.718633792], 
            [ 298.961820737, -22.131818525, 298.937824136, -22.134153957,    8.861799341, -50.415212896], 
            [ 240.523866415, -18.586891962, 240.515423941, -18.583967537,   76.208491877, -28.455846173], 
            [ 330.751444143, -13.513287299, 330.756590337, -13.511080656,  327.927100746, -38.687508326], 
            [ 279.176073756, -23.612603066, 279.195224400, -23.611508794,   37.142155273, -48.133959008], 
            [ 233.121781596, -15.457077500, 233.155467737, -15.466057588,   81.555803740, -22.167104760], 
            [ 317.418492827, -18.253326281, 317.466826576, -18.240499278,  342.619333262, -45.832360544], 
            [ 259.490302031, -22.388519340, 259.557433619, -22.395142345,   60.089049658, -39.891180928], 
            [ 301.472635767, -17.657834086, 301.552764956, -17.643533423,    5.180298132, -46.067661615], 
            [ 299.557803762, -22.045476664, 299.656797892, -22.029164265,    7.897491829, -50.356203571], 
            [ 240.964623519, -18.714166415, 241.077730639, -18.737257111,   75.825197363, -28.820039647], 
            [ 330.884607584, -13.425073015, 331.005808659, -13.382213625,  327.755266081, -38.517673067], 
            [ 279.796658021, -23.608843867, 279.947496683, -23.600156019,   36.246295433, -48.317456986], 
            [ 232.900480538, -15.465978485, 233.055832192, -15.503272039,   81.729919144, -22.119151647], 
            [ 317.907575239, -18.115237957, 318.075613064, -18.065147362,  341.931814960, -45.580637726], 
            [ 260.074731270, -22.466339947, 260.269452050, -22.476995268,   59.443376265, -40.228952581], 
            [ 297.724735986, -18.082660724, 297.923449764, -18.044670063,   10.281745569, -46.230927106], 
            [ 300.146300592, -21.958291219, 300.362575679, -21.914791539,    6.949548230, -50.281910134], 
            [ 241.411461136, -18.840748854, 241.638596882, -18.880026376,   75.432516245, -29.175869871], 
            [ 330.991385979, -13.343442852, 331.213982799, -13.261471823,  327.614926302, -38.362691176], 
            [ 280.420036779, -23.602052767, 280.683733401, -23.582344875,   35.342295386, -48.490667962], 
            [ 232.733045726, -15.485499873, 232.991851127, -15.546585823,   81.859542306, -22.101299167], 
            [ 318.393687802, -17.976419673, 318.664292056, -17.895578302,  341.254371465, -45.332649986]        
        ];        

        testPlanet(venusData, 2);
    });

    it('Sun', function() {
        const sunData : number[][] = [
            [ 281.985634866, -22.986142366, 281.674330031, -23.007220335,   32.740463852, -48.414121772], 
            [ 282.808831746, -22.920752478, 282.511544500, -22.942905815,   32.586904999, -48.376843542], 
            [ 282.528348215, -22.943589757, 282.245273682, -22.964850009,   32.633003725, -48.390791533], 
            [ 282.241139401, -22.965810849, 281.972877943, -22.986225648,   32.687595864, -48.402494579], 
            [ 281.960762613, -22.987383859, 281.707714694, -23.007000864,   32.732564871, -48.415424560], 
            [ 282.779266167, -22.922911116, 282.542382533, -22.943340788,   32.586660728, -48.377343677], 
            [ 282.491945623, -22.945663612, 282.271452794, -22.964984587,   32.642886447, -48.389020945], 
            [ 282.209916364, -22.967886729, 282.006098811, -22.985857648,   32.686538587, -48.402315947], 
            [ 281.927203167, -22.989181176, 281.740009818, -23.005620868,   32.735899195, -48.413340498], 
            [ 282.748756388, -22.924841938, 282.578483837, -22.940762203,   32.585756394, -48.374832975], 
            [ 282.467049248, -22.947226387, 282.313347552, -22.961125894,   32.633644606, -48.386788933], 
            [ 282.180403828, -22.969694173, 282.042852139, -22.981385865,   32.687382288, -48.397494548], 
            [ 281.900950518, -22.991047304, 281.778883684, -23.000534274,   32.725603546, -48.410037236], 
            [ 282.724557662, -22.926163280, 282.617683619, -22.934261930,   32.576574676, -48.369836255], 
            [ 282.440660833, -22.948962972, 282.348346276, -22.954917678,   32.626318448, -48.381739285], 
            [ 282.159321417, -22.970507248, 282.080959933, -22.974504851,   32.672570039, -48.393194451], 
            [ 281.874569432, -22.992483237, 281.809680887, -22.994864601,   32.723450813, -48.404548084], 
            [ 282.692009369, -22.928393489, 282.640562610, -22.929875008,   32.578664801, -48.364864443], 
            [ 282.407904940, -22.951005167, 282.369880588, -22.951420959,   32.630304988, -48.377326845], 
            [ 282.121590534, -22.973332349, 282.097087308, -22.972987843,   32.685782333, -48.389056557], 
            [ 281.841503670, -22.994181781, 281.830874887, -22.993389211,   32.727555115, -48.402215525], 
            [ 282.664765451, -22.930227958, 282.668676207, -22.929120972,   32.577300820, -48.364342527], 
            [ 282.379079495, -22.952528310, 282.398115534, -22.951047441,   32.627589397, -48.377462801], 
            [ 282.097246797, -22.974528027, 282.131831716, -22.972669318,   32.672803514, -48.391237349], 
            [ 281.815214465, -22.995895518, 281.865887930, -22.993621019,   32.718352612, -48.404240661], 
            [ 282.636838647, -22.931706900, 282.704081157, -22.928345653,   32.570447319, -48.364857991], 
            [ 282.355711250, -22.954200533, 282.439782735, -22.949846943,   32.620203566, -48.377640091], 
            [ 282.070631616, -22.975944387, 282.171440795, -22.970413743,   32.668387780, -48.389742539], 
            [ 281.787127195, -22.997642625, 281.904606466, -22.990796496,   32.714374248, -48.402069210], 
            [ 282.607147641, -22.933711775, 282.741023720, -22.924410851,   32.572638183, -48.360337679], 
            [ 282.321080565, -22.956300879, 282.471016139, -22.945216961,   32.622577368, -48.372359292], 
            [ 282.037909242, -22.978052078, 282.203225471, -22.965208183,   32.668642318, -48.384271173], 
            [ 281.757612700, -22.998957278, 281.937814840, -22.984474642,   32.710544111, -48.396225785], 
            [ 282.578074058, -22.935622213, 282.772481199, -22.918278729,   32.569017192, -48.354650998], 
            [ 282.293976713, -22.957775640, 282.502261115, -22.939036692,   32.616216106, -48.367152259], 
            [ 282.010213172, -22.979905346, 282.231965353, -22.960131379,   32.663189545, -48.380038498], 
            [ 281.728393353, -23.000877380, 281.963567874, -22.980430150,   32.712270185, -48.391678123], 
            [ 282.551931352, -22.937158032, 282.800360202, -22.914600988,   32.565953040, -48.351412682], 
            [ 282.269925032, -22.959296541, 282.532098971, -22.936536661,   32.610717889, -48.365611142], 
            [ 281.984542652, -22.980888559, 282.260870779, -22.958211688,   32.660491471, -48.378561098], 
            [ 281.702315460, -23.002459128, 281.993475709, -22.979983819,   32.706563754, -48.392318896]
        ];

        testPlanet(sunData, 0);
    });


    it('Moon', function() {
        const moonData : number[][] = [
            [  96.667461441,  18.485067533,  96.378021084,  18.495093357,  217.607647149,  42.644669389], 
            [ 231.721844856, -14.154562666, 231.450531248, -14.085892220,   82.667386444, -20.003733783], 
            [ 358.440904504,  -6.495502416, 358.204674465,  -6.598433744,  300.600208305, -22.694020426], 
            [ 140.550535384,  18.507171049, 140.312597464,  18.579720606,  158.835907153,  45.732227531], 
            [ 267.038172824, -24.989429053, 266.780597250, -24.984892853,   52.490137936, -45.449424389], 
            [  39.412110206,  13.358644305,  39.206338787,  13.294438774,  273.123566996,  13.467847995], 
            [ 171.295458619,   7.232576097, 171.114419429,   7.309762252,  127.414797382,  26.163899091], 
            [ 311.456989450, -23.453920881, 311.260939507, -23.505334543,  350.591665799, -51.762740930], 
            [  75.712128817,  27.210168626,  75.531174096,  27.196610028,  246.469247246,  42.783152651], 
            [ 208.183486745, -16.655804151, 208.033396401, -16.602342929,  104.450044495, -11.078400717], 
            [ 340.644088767,  -6.655925650, 340.514161316,  -6.708824540,  318.828963478, -29.303208433], 
            [ 120.387120463,  19.813567320, 120.266775317,  19.837843923,  186.640251089,  48.213379813], 
            [ 246.694610194, -25.087196852, 246.572823440, -25.069582323,   74.194227272, -36.902717108], 
            [  17.331209404,  11.657703364,  17.244473663,  11.622882594,  291.441947037,   1.766692366], 
            [ 152.597769749,   5.022286503, 152.527175941,   5.048887590,  148.172333798,  29.986819700], 
            [ 289.714575621, -18.238576415, 289.639193133, -18.246242248,   20.993821303, -45.415077987], 
            [  56.824539743,  16.332135860,  56.774646501,  16.318945275,  258.432754648,  24.748830223], 
            [ 190.665236944,  -4.432823766, 190.627169769,  -4.416084556,  114.131829431,   7.611390638], 
            [ 325.765486526, -12.713579193, 325.732632184, -12.723038825,  333.948452672, -39.024877265], 
            [  99.913350752,  18.888123106,  99.901870883,  18.886631091,  213.872209139,  43.891790187], 
            [ 228.710739023, -13.436857006, 228.703457581, -13.434003815,   84.265972539, -18.412525069], 
            [   2.497655785,  -5.130988045,   2.505433918,  -5.128211840,  297.475797333, -19.728879849], 
            [ 139.471899749,  19.240947490, 139.500286822,  19.232245105,  160.288065887,  46.575141268], 
            [ 270.448505998, -25.972255541, 270.484054313, -25.972931560,   49.112698956, -47.576189711], 
            [  36.785577690,  12.993923100,  36.838998218,  13.012371492,  274.527947895,  12.377149414], 
            [ 173.709538995,   5.419411060, 173.773927891,   5.391790535,  125.934665021,  23.525107244], 
            [ 310.793312770, -23.329501956, 310.875763913, -23.311132531,  351.768397499, -51.626262691], 
            [  79.663957143,  27.565175904,  79.780689254,  27.575028796,  242.574294301,  44.775897407], 
            [ 205.887460476, -16.105841204, 205.995748858, -16.146528450,  105.463567441, -10.012628182], 
            [ 342.048709741,  -5.216049742, 342.166215240,  -5.168354433,  318.037594250, -27.444351802], 
            [ 120.077984321,  19.189791775, 120.233594203,  19.160517775,  187.173566084,  47.512968456], 
            [ 251.174641295, -24.746227379, 251.342099094, -24.765698779,   69.653634250, -38.624782872], 
            [  15.312879069,  10.551536880,  15.475037062,  10.618152076,  292.016046769,   0.349745810], 
            [ 153.515764313,   4.802827876, 153.692238413,   4.734963128,  147.407696916,  29.486811978], 
            [ 289.915815815, -18.011896824, 290.115765375, -17.983387473,   20.812049422, -45.171186026], 
            [  61.814376923,  16.432418676,  62.034841880,  16.470226502,  253.961992653,  27.138879130], 
            [ 188.490352307,  -2.991777843, 188.696134808,  -3.079471980,  114.759088925,   9.396151935], 
            [ 326.242557061, -13.263117355, 326.466314210, -13.184929444,  333.401622921, -39.403804542], 
            [ 100.254351436,  19.377952003, 100.522336618,  19.357676972,  213.765718604,  44.405016388], 
            [ 234.229821032, -15.257266527, 234.488589131, -15.316187215,   80.377032138, -22.606067276], 
            [ 359.650428470,  -6.424359122, 359.901399042,  -6.315913927,  298.876326803, -21.650724388]
        ];        

        testPlanet(moonData, 4);
    });

    it('Mars', function() {
        const marsData : number[][] = [
            [ 166.882890045,   9.048151986, 166.622546647,   9.155529964,  130.735686455,  29.340627348], 
            [ 304.416189882, -20.841672808, 304.129745336, -20.901719749,    1.781667489, -49.397934626], 
            [ 188.018514016,  -0.901607181, 187.784092039,  -0.800882750,  114.797633503,  11.943012079], 
            [ 320.840316320, -16.522354464, 320.595524988, -16.598317921,  338.965232892, -43.734666925], 
            [ 204.172395555,  -8.304280029, 203.956492914,  -8.221168488,  103.290319894,  -2.175770784], 
            [ 338.246410477, -10.144290564, 338.042143195, -10.225006066,  320.482506848, -33.468784593], 
            [ 219.278277054, -14.274424090, 219.080671739, -14.213630406,   93.492243711, -14.321205810], 
            [ 356.166739451,  -2.145868730, 355.997665767,  -2.219320546,  304.451643772, -19.492498562], 
            [ 233.548030817, -18.744255144, 233.371800945, -18.705508246,   82.788188121, -25.252446238], 
            [  19.058032327,   8.667463975,  18.916349101,   8.611381856,  288.574603652,  -0.149176430], 
            [ 248.882245899, -22.061005826, 248.731057187, -22.042294565,   70.684958374, -35.039183324], 
            [  55.039354693,  21.969321335,  54.916229757,  21.943589948,  263.471215009,  28.648506722], 
            [ 264.138467041, -23.804473960, 264.015569192, -23.800102407,   55.060860121, -43.284992246], 
            [ 112.400323665,  25.789707753, 112.304756286,  25.802376530,  200.027112104,  53.212971530], 
            [ 280.857414129, -23.900592615, 280.764332977, -23.905642325,   35.147930399, -48.870160724], 
            [ 155.981936296,  13.764694759, 155.921320573,  13.786438587,  141.091050099,  37.373657536], 
            [ 297.161111314, -22.186291294, 297.097405075, -22.194862064,   11.147659145, -50.345144385], 
            [ 180.701249531,   2.598072145, 180.664103922,   2.613917522,  120.326979348,  18.203443942], 
            [ 314.385853724, -18.427281026, 314.350701852, -18.434966528,  347.429928447, -46.465172181], 
            [ 198.160161902,  -5.638537661, 198.144138440,  -5.631417996,  107.525197307,   2.960681297], 
            [ 330.895494770, -13.041096394, 330.887675847, -13.043094992,  327.035292179, -38.011244447], 
            [ 213.644867198, -12.176915605, 213.651889781, -12.178960548,   97.508055715,  -9.796073749], 
            [ 348.854319926,  -5.531631963, 348.873804636,  -5.523451964,  310.571448056, -25.382001656], 
            [ 227.925960398, -17.137099560, 227.960113581, -17.146859401,   87.113444898, -21.161471249], 
            [   8.898760166,   3.926245107,   8.946894538,   3.947128281,  294.823544111,  -8.463705628], 
            [ 243.061301958, -20.982472440, 243.127455105, -20.995752802,   75.843018349, -31.405624236], 
            [  38.303205141,  16.680097198,  38.388081079,  16.708641514,  275.505775084,  16.087257856], 
            [ 258.074829820, -23.300368567, 258.175959391, -23.310266350,   61.607178440, -40.328452803], 
            [  89.326796622,  26.948919857,  89.461038397,  26.951578888,  230.708552121,  48.169903826], 
            [ 274.545972366, -24.081875385, 274.681419267, -24.079445334,   43.538226640, -47.084317566], 
            [ 142.179689811,  18.886114245, 142.328904833,  18.839441473,  156.695356553,  45.706553737], 
            [ 290.714642299, -23.078114198, 290.879029317, -23.056446673,   20.765243743, -50.335173140], 
            [ 172.147582506,   6.618576114, 172.308431302,   6.549344630,  126.233261179,  24.895508339], 
            [ 307.939696614, -20.061357916, 308.125412432, -20.015813628,  356.455922924, -48.484351483], 
            [ 191.786135222,  -2.690260493, 191.968980354,  -2.767384176,  112.082666798,   8.453525923], 
            [ 324.377866678, -15.362222156, 324.579791280, -15.293761283,  334.516963308, -41.751254941], 
            [ 207.392127587,  -9.678779694, 207.602592383,  -9.755941835,  101.053005763,  -5.113261530], 
            [ 341.905449407,  -8.598861015, 342.122820035,  -8.509957441,  316.903607666, -30.637143183], 
            [ 222.357956328, -15.348470083, 222.601326070, -15.419198941,   91.249430929, -16.931556920], 
            [   0.426856292,  -0.116684557,   0.665469316,  -0.013040627,  301.129765441, -15.696881929], 
            [ 236.640606166, -19.544287763, 236.920830689, -19.602965608,   80.264798962, -27.591905401]            
        ];        

        testPlanet(marsData, 5);
    });

    it('Jupiter', function() {
        const jupiterData : number[][] = [
            [ 162.395295086,   8.694527251, 162.134247224,   8.799436666,  135.670006891,  30.568489707], 
            [ 189.563812740,  -2.695903612, 189.316652063,  -2.590090787,  114.402161379,   9.769713417], 
            [ 214.546578510, -12.567715560, 214.297076031, -12.482313395,   96.756289942, -10.552960404], 
            [ 239.681679892, -19.680817285, 239.425420637, -19.630827065,   77.924085127, -28.806968715], 
            [ 266.051512825, -23.070286669, 265.797730600, -23.064200037,   52.518929048, -43.329419941], 
            [ 293.713459892, -21.908506533, 293.480608878, -21.944662917,   17.193794114, -49.598718417], 
            [ 321.360266684, -15.993429625, 321.160227050, -16.057719174,  338.717910828, -43.152378111], 
            [ 349.300656583,  -5.907572839, 349.129827596,  -5.980523142,  309.755419971, -25.583046890], 
            [  19.381221321,   6.802960798,  19.225865226,   6.741062633,  286.786697952,  -1.331001077], 
            [  54.731262556,  18.573228817,  54.579302612,  18.540930481,  262.278412101,  25.328133731], 
            [  95.673019019,  23.221833098,  95.531101358,  23.228704108,  221.540398744,  46.689190404], 
            [ 134.663145281,  17.851902167, 134.546042028,  17.885220698,  166.852000397,  45.866935458], 
            [ 166.392532831,   7.100194917, 166.295600941,   7.140590406,  132.008620409,  27.613474493], 
            [ 193.080038941,  -4.185705698, 192.994019389,  -4.149539091,  111.854400146,   6.799572937], 
            [ 217.955009307, -13.731601355, 217.874983513, -13.705024468,   94.344072273, -13.271762956], 
            [ 243.207665041, -20.385030115, 243.133408039, -20.370419096,   74.942246925, -31.123610414], 
            [ 269.743360362, -23.195395953, 269.678500060, -23.192723688,   48.151079718, -44.836520071], 
            [ 297.479406820, -21.377516249, 297.429135553, -21.383773028,   11.609541580, -49.499542125], 
            [ 325.137200565, -14.839318556, 325.103898526, -14.848814099,  334.130237571, -41.232232487], 
            [ 353.239292309,  -4.266895560, 353.222090001,  -4.274065997,  306.421504624, -22.500984465], 
            [  23.888244781,   8.605420244,  23.886220307,   8.603778781,  283.639579569,   2.423622504], 
            [  60.177960296,  19.792236577,  60.192680940,  19.794278814,  257.889373489,  29.012513280], 
            [ 101.423042425,  23.027956464, 101.454712037,  23.025690131,  213.910886652,  48.202038592], 
            [ 139.455789051,  16.550925081, 139.498173600,  16.538573254,  160.614279445,  43.881815925], 
            [ 170.220182398,   5.530515913, 170.270818564,   5.509201393,  128.663558921,  24.679643161], 
            [ 196.460701977,  -5.598446525, 196.522876358,  -5.624860885,  109.436314780,   3.942224053], 
            [ 221.268974029, -14.808115535, 221.347673745, -14.833772648,   91.966393460, -15.867199335], 
            [ 246.675710522, -21.002838304, 246.774664433, -21.019775454,   71.890321325, -33.314865871], 
            [ 273.413059506, -23.233724382, 273.531026122, -23.233168834,   43.592976207, -46.163097671], 
            [ 301.260524412, -20.754418893, 301.390448909, -20.730078400,    6.015875079, -49.130182916], 
            [ 328.981422446, -13.586865352, 329.117133924, -13.539406314,  329.694501427, -39.078389613], 
            [ 357.317131869,  -2.538692818, 357.461381807,  -2.476257356,  303.105690153, -19.223158674], 
            [  28.612302776,  10.421218176,  28.778460580,  10.481613527,  280.352863811,   6.316006468], 
            [  65.814507874,  20.864034774,  66.015945145,  20.893483920,  253.081991027,  32.612222614], 
            [ 107.133524207,  22.629599078, 107.353052180,  22.603279960,  205.919709464,  49.174075661], 
            [ 144.132865314,  15.158548223, 144.343359159,  15.087309182,  154.873961521,  41.597696450], 
            [ 174.020778986,   3.940665782, 174.227600202,   3.851072489,  125.485234015,  21.677746552], 
            [ 199.902309916,  -7.008792447, 200.121855116,  -7.095959590,  107.007708249,   1.045777896], 
            [ 224.703773380, -15.862641271, 224.948405033, -15.930504000,   89.455050660, -18.495694779], 
            [ 250.293475115, -21.567619975, 250.566653351, -21.600594837,   68.564258855, -35.487370975], 
            [ 277.217355999, -23.183954813, 277.509521426, -23.169744224,   38.653796498, -47.325074557]
        ];

        testPlanet(jupiterData, 6);
    });


    it('Saturn', function() {
        const saturnData : number[][] = [
            [ 178.363520341,   3.069893725, 178.106219644,   3.181216380, 121.707024734,  19.411676988, 8.3085742582], 
            [ 189.933771027,  -1.714142168, 189.686822624,  -1.608532797, 113.629057855,  10.491590345, 8.3580554960], 
            [ 201.022373528,  -6.223012959, 200.783002474,  -6.127251955, 105.519050502,   1.363919152, 8.3421504060], 
            [ 211.825477396, -10.330044953, 211.592229661, -10.247307088,  97.807606167,  -7.428106930, 8.3262735612], 
            [ 222.489935268, -13.943419615, 222.262438410, -13.875908039,  90.090952675, -15.787708953, 8.3104089515], 
            [ 233.216162484, -17.012787466, 232.995458063, -16.962007370,  82.820909834, -23.225576242, 8.3600899801], 
            [ 243.890233078, -19.437530720, 243.678327445, -19.403665859,  74.035087137, -30.452194882, 8.3443877476], 
            [ 254.623216399, -21.195755811, 254.422647820, -21.178015716,  64.140946980, -36.906323275, 8.3284431094], 
            [ 265.411936373, -22.255814845, 265.225199067, -22.252556261,  52.761218256, -42.358973755, 8.3127581407], 
            [ 276.358211386, -22.594978640, 276.187787196, -22.604036912,  40.702025189, -46.234068602, 8.3625057051], 
            [ 287.167052584, -22.207795669, 287.014766641, -22.226144444,  26.003176402, -48.774213367, 8.3467992529], 
            [ 297.925120505, -21.108268704, 297.791574336, -21.132876116,  10.296324730, -49.330966357, 8.3310300183], 
            [ 308.609796192, -19.319081701, 308.494671707, -19.347190294, 354.703112925, -47.769457416, 8.3149416891], 
            [ 319.327402004, -16.843158654, 319.229968581, -16.872371918, 341.452289966, -44.318844073, 8.3647959714], 
            [ 329.887712712, -13.787181467, 329.806814921, -13.815347959, 328.620136668, -39.146618507, 8.3488964410], 
            [ 340.476426346, -10.180073014, 340.410633506, -10.205643138, 317.401798385, -32.580528164, 8.3329739719], 
            [ 351.200277994,  -6.092160809, 351.148315183,  -6.114015709, 307.468074763, -24.890137927, 8.3170069080], 
            [   2.247256832,  -1.591611305,   2.208260718,  -1.608869336, 299.291516930, -16.649319169, 8.3665181797], 
            [  13.685644335,   3.140676180,  13.659252630,   3.128653325, 290.605428000,  -7.322812796, 8.3506053963], 
            [  25.784622669,   7.958640916,  25.770801589,   7.952024815, 281.896287305,   2.613277955, 8.3347428896], 
            [  38.755645242,  12.615283317,  38.755013584,  12.613768728, 272.633019293,  12.955256651, 8.3186566082], 
            [  52.731479850,  16.775619271,  52.745296629,  16.778087217, 263.059898682,  22.888668014, 8.3683399684], 
            [  67.835049594,  20.052757511,  67.864865714,  20.056960626, 250.466436349,  32.872620801, 8.3523595900], 
            [  83.876918914,  22.036043354,  83.923528672,  22.038681890, 234.518829269,  41.527733418, 8.3364158571], 
            [ 100.404806938,  22.423236028, 100.467850078,  22.420594414, 214.319147240,  47.486647080, 8.3205249935], 
            [ 116.705564781,  21.158588713, 116.783454454,  21.147313596, 192.571148643,  49.194121727, 8.3703733747], 
            [ 132.387563907,  18.408656984, 132.477879943,  18.386578788, 170.093654568,  46.597048876, 8.3547927945], 
            [ 147.028977553,  14.556051607, 147.129743427,  14.522769815, 151.484875168,  40.434399300, 8.3388829070], 
            [ 160.568475999,  10.026783367, 160.679111091,   9.983239750, 137.027624866,  32.234833946, 8.3229666809], 
            [ 173.128529554,   5.204373678, 173.249747039,   5.152361777, 126.600517513,  23.521296448, 8.3730286716], 
            [ 184.932880872,   0.362432781, 185.065810467,   0.304574423, 117.038884927,  14.204400294, 8.3570914406], 
            [ 196.175473312,  -4.274973216, 196.321660876,  -4.335637956, 108.639093090,   4.984523178, 8.3411244767], 
            [ 207.052122535,  -8.560934893, 207.213330687,  -8.621260792, 100.827296648,  -3.945434509, 8.3251223462], 
            [ 217.801842878, -12.413241512, 217.979779672, -12.469971496,  93.976173695, -12.057214462, 8.3750734102], 
            [ 228.414147665, -15.713238710, 228.609656302, -15.763121535,  86.102326141, -20.108698244, 8.3589859965], 
            [ 239.033143353, -18.418339682, 239.246514450, -18.458381079,  77.666771545, -27.587618186, 8.3428744610], 
            [ 249.707555165, -20.480298883, 249.938535851, -20.507824340,  68.293531435, -34.365123774, 8.3270111434], 
            [ 260.571849481, -21.869155987, 260.819554278, -21.881557144,  58.531528802, -39.908814910, 8.3768558493], 
            [ 271.369149751, -22.535291999, 271.631692158, -22.530721956,  46.239995589, -44.678293713, 8.3607524398], 
            [ 282.176993645, -22.481240234, 282.452353756, -22.458017434,  32.198017942, -47.947006139, 8.3447068406], 
            [ 292.953539802, -21.709700117, 293.239480948, -21.667193223,  16.805691263, -49.356392806, 8.3287285945]
        ];        

        testPlanet(saturnData, 7);
    });

    it('Uranus', function() {
        const uranusData : number[][] = [
            [ 232.086587667, -18.596512169, 231.795167190, -18.524458488,   84.057038560, -24.377964194], 
            [ 236.555039572, -19.660359684, 236.272588455, -19.598592267,   81.261661426, -27.075548667], 
            [ 240.991270747, -20.595584218, 240.718792516, -20.544099269,   77.456872279, -30.091750686], 
            [ 245.439090806, -21.409614134, 245.177763612, -21.368249266,   73.461442179, -32.977557133], 
            [ 249.893747963, -22.099531927, 249.644630140, -22.067913151,   69.248216525, -35.715950001], 
            [ 254.409224186, -22.669323403, 254.173669867, -22.647017221,   65.750479260, -37.893204502], 
            [ 258.858015660, -23.103824028, 258.637263874, -23.089894116,   61.069147588, -40.290880083], 
            [ 263.291827905, -23.410693345, 263.086834885, -23.404041139,   56.106152021, -42.481972517], 
            [ 267.703320756, -23.590820520, 267.514597946, -23.590282384,   50.860276468, -44.439497869], 
            [ 272.151966672, -23.645385313, 271.980048007, -23.649847061,   46.446668570, -45.826787818], 
            [ 276.502362419, -23.576446343, 276.347454642, -23.584555626,   40.686777800, -47.279773623], 
            [ 280.814754010, -23.388249342, 280.676565618, -23.398790346,   34.680605531, -48.435597443], 
            [ 285.085794467, -23.084289246, 284.963949568, -23.096204264,   28.468017540, -49.276044294], 
            [ 289.375081056, -22.660831602, 289.268971419, -22.673335922,   23.410777707, -49.606709652], 
            [ 293.550612822, -22.136243668, 293.459685820, -22.148526000,   17.033320755, -49.820869264], 
            [ 297.674467931, -21.509150756, 297.597988225, -21.520625546,   10.670189244, -49.697686255], 
            [ 301.744228708, -20.784773151, 301.681570377, -20.795061198,    4.403490563, -49.244128177], 
            [ 305.815432335, -19.955545964, 305.766319402, -19.964292161,  359.619304160, -48.469290050], 
            [ 309.770410154, -19.052239025, 309.734699303, -19.058990565,  353.738523784, -47.447745602], 
            [ 313.668004825, -18.068885334, 313.645572072, -18.073232827,  348.124300836, -46.152694886], 
            [ 317.508996836, -17.011405603, 317.499943975, -17.012898035,  342.796950793, -44.609760667], 
            [ 321.343573270, -15.870279273, 321.348197455, -15.868299266,  338.986184254, -42.995516625], 
            [ 325.076225831, -14.681766397, 325.094822305, -14.675601124,  334.224075955, -41.070426166], 
            [ 328.762954282, -13.435806289, 328.795605241, -13.424825330,  329.744818710, -38.970114384], 
            [ 332.409615597, -12.137142272, 332.456512014, -12.120716070,  325.529227208, -36.715293972], 
            [ 336.059664263, -10.775569152, 336.120937831, -10.753065880,  322.638017100, -34.588021189], 
            [ 339.641480418,  -9.386042408, 339.717144899,  -9.356970557,  318.853212908, -32.102567391], 
            [ 343.202126596,  -7.957553111, 343.291932237,  -7.921677661,  315.256923000, -29.507163343], 
            [ 346.747815583,  -6.494747868, 346.851615368,  -6.451955910,  311.831290086, -26.815683380], 
            [ 350.311399872,  -4.990288311, 350.428979581,  -4.940616228,  309.535557721, -24.384945154], 
            [ 353.843050740,  -3.473987599, 353.974165351,  -3.417667448,  306.363152227, -21.550474614], 
            [ 357.377799778,  -1.938142106, 357.522024537,  -1.875644543,  303.300708397, -18.648370699], 
            [   0.921472703,  -0.388088877,   1.078592619,  -0.319910354,  300.329379555, -15.686754648], 
            [   4.494229866,   1.177480489,   4.664072750,   1.250771193,  298.341467659, -13.078509831], 
            [   8.069825322,   2.737484827,   8.252308351,   2.815294242,  295.486663798, -10.033338134], 
            [  11.673879403,   4.295124389,  11.868971469,   4.376862324,  292.672863479,  -6.947420933], 
            [  15.313834411,   5.844834421,  15.521850071,   5.930044615,  289.886401165,  -3.827512258], 
            [  19.000358312,   7.382603050,  19.221715956,   7.470826160,  287.973217576,  -1.122427062], 
            [  22.733971192,   8.898001346,  22.969300749,   8.988827330,  285.173299784,   2.048273587], 
            [  26.528492752,  10.387640376,  26.778575899,  10.480671261,  282.346270588,   5.242010421], 
            [  30.392302638,  11.844670717,  30.658199052,  11.939464890,  279.472534539,   8.453772976]       
         ];        

        testPlanet(uranusData, 8);
    });

    it('Neptune', function() {
        const neptuneData : number[][] = [
            [ 260.567300301, -21.814980331, 260.259130862, -21.793562514,   57.976161985, -40.017904890], 
            [ 262.842249456, -21.978309779, 262.546931331, -21.962576730,   56.373501354, -40.790155168], 
            [ 265.085301367, -22.109267118, 264.803558345, -22.099006411,   53.656685393, -41.889465795], 
            [ 267.333762604, -22.209628665, 267.066377880, -22.204529254,   50.849636083, -42.929592173], 
            [ 269.586637266, -22.279127912, 269.334188322, -22.278795753,   47.951187204, -43.905902341], 
            [ 271.882206483, -22.317094203, 271.645519065, -22.321121229,   46.101759507, -44.491955146], 
            [ 274.137905007, -22.323758892, 273.917659630, -22.331412478,   43.053295948, -45.341514981], 
            [ 276.392204898, -22.299267319, 276.188803195, -22.309754060,   39.916048537, -46.114748261], 
            [ 278.643460986, -22.243742654, 278.456920118, -22.256310595,   36.704788061, -46.804739487], 
            [ 280.931844111, -22.154687154, 280.762272666, -22.168645430,   34.648291460, -47.155085518], 
            [ 283.175828306, -22.037120412, 283.023291725, -22.051606133,   31.317979454, -47.691376032], 
            [ 285.416427320, -21.889078093, 285.280307715, -21.903517538,   27.924989326, -48.136347182], 
            [ 287.654329849, -21.710640732, 287.533925056, -21.724468739,   24.471728222, -48.487630515], 
            [ 289.929513527, -21.497083355, 289.824338067, -21.509932340,   22.285562765, -48.569711937], 
            [ 292.160888336, -21.257922184, 292.070389330, -21.269417142,   18.774545865, -48.748934127], 
            [ 294.388446447, -20.988997339, 294.311935951, -20.998926532,   15.240836201, -48.827716081], 
            [ 296.611087715, -20.690757878, 296.548013635, -20.699076619,   11.697926361, -48.805160836], 
            [ 298.866047277, -20.356848620, 298.816234689, -20.363510933,    9.494901640, -48.604940675], 
            [ 301.074195912, -20.001158995, 301.037614087, -20.006014513,    5.980847911, -48.406322151], 
            [ 303.272903144, -19.618111437, 303.249557687, -19.621029219,    2.499490088, -48.108012318], 
            [ 305.461026050, -19.208484844, 305.451163590, -19.209292013,  359.057820296, -47.712081521], 
            [ 307.674150534, -18.764757990, 307.678254731, -18.763093237,  356.996380060, -47.241584887], 
            [ 309.839170609, -18.304020389, 309.857687897, -18.299386007,  353.665903503, -46.684240687], 
            [ 311.994091871, -17.818721373, 312.027253764, -17.810636594,  350.404499719, -46.037334987], 
            [ 314.139923780, -17.309309385, 314.188052767, -17.297248116,  347.217624631, -45.304142276], 
            [ 316.310606190, -16.766903503, 316.373943981, -16.750228073,  345.379468368, -44.598368871], 
            [ 318.439640827, -16.210628306, 318.518198403, -16.188745516,  342.339253365, -43.726746668], 
            [ 320.561576352, -15.631855860, 320.655046778, -15.604335334,  339.374624167, -42.778309396], 
            [ 322.676540402, -15.031330129, 322.784654812, -14.997813205,  336.493564399, -41.757697655], 
            [ 324.814101695, -14.400026256, 324.936466664, -14.360175827,  334.899396904, -40.858170096], 
            [ 326.913285903, -13.758696137, 327.049359444, -13.712339455,  332.166786521, -39.725803248], 
            [ 329.004016851, -13.098698834, 329.153045319, -13.045880952,  329.518424074, -38.533794458], 
            [ 331.085751177, -12.421238081, 331.247179547, -12.362051631,  326.952769250, -37.286583519], 
            [ 333.183764915, -11.717907748, 333.357049389, -11.652461077,  325.593557263, -36.242985989], 
            [ 335.245952874, -11.009108594, 335.430611110, -10.937605371,  323.165916492, -34.914005862], 
            [ 337.300597628, -10.285698529, 337.496236750, -10.208381457,  320.811714655, -33.540020248], 
            [ 339.348911915,  -9.548316117, 339.555482485,  -9.465308793,  318.530837103, -32.124881193], 
            [ 341.414071003,  -8.788554815, 341.631606033,  -8.699895249,  317.365115583, -30.976026833], 
            [ 343.453167084,  -8.025224834, 343.681889392,  -7.930902441,  315.187050067, -29.495028072], 
            [ 345.490060679,  -7.249799846, 345.730322672,  -7.149728001,  313.066148538, -27.977799915], 
            [ 347.526031947,  -6.462984339, 347.778403532,  -6.356937841,  310.998107641, -26.426274874]
        ];        

        testPlanet(neptuneData, 9);
    });

    it('Pluto', function() {
        const plutoData : number[][] = [
            [ 206.580170927,   7.296727233, 206.326509869,   7.397118344,   93.754209476,  10.455674976], 
            [ 208.835174956,   6.378096431, 208.592415305,   6.471893307,   92.858558521,   8.918033956], 
            [ 211.077475880,   5.441776286, 210.845882921,   5.528762627,   91.119443425,   6.901886899], 
            [ 213.321209536,   4.494178222, 213.101174047,   4.574169638,   89.387407072,   4.874056464], 
            [ 215.565464452,   3.537538877, 215.357251460,   3.610460798,   87.659672747,   2.837902439], 
            [ 217.830228475,   2.575360234, 217.634411614,   2.641074034,   86.777771631,   1.255871180], 
            [ 220.073166200,   1.606511992, 219.890114376,   1.665166028,   85.053689026,  -0.788057964], 
            [ 222.313950014,   0.634712527, 222.143946375,   0.686590760,   83.323954906,  -2.832861650], 
            [ 224.552616454,  -0.338363220, 224.395682749,  -0.292850495,   81.592294655,  -4.872350659], 
            [ 226.816101500,  -1.311977673, 226.672468544,  -1.272491528,   80.700373684,  -6.457953036], 
            [ 229.054573891,  -2.283185198, 228.924226947,  -2.249141627,   78.949870750,  -8.488396128], 
            [ 231.293271737,  -3.250063472, 231.176004871,  -3.220823498,   77.182562324, -10.509204428], 
            [ 233.532764850,  -4.210356554, 233.428164401,  -4.185340074,   75.391119453, -12.519338918], 
            [ 235.802149492,  -5.163716075, 235.710068858,  -5.142519686,   74.452716100, -14.074991166], 
            [ 238.042313731,  -6.104009339, 237.962426038,  -6.086127880,   72.622453079, -16.052868885], 
            [ 240.281107717,  -7.030691777, 240.213031936,  -7.015733440,   70.763795140, -18.008071592], 
            [ 242.517110412,  -7.941660983, 242.460541686,  -7.929418830,   68.873897481, -19.937206606], 
            [ 244.782157237,  -8.837908427, 244.737197370,  -8.828337293,   67.854810762, -21.421187233], 
            [ 247.009814436,  -9.712226675, 246.976574198,  -9.705189505,   65.907710443, -23.294193502], 
            [ 249.230986609, -10.565928641, 249.209676274, -10.561350160,   63.923482667, -25.131442512], 
            [ 251.445640267, -11.397962898, 251.436709558, -11.395823733,   61.894195677, -26.932432223], 
            [ 253.689186488, -12.210122123, 253.693457618, -12.210318972,   60.778137758, -28.301577168], 
            [ 255.891986450, -12.995598061, 255.910133082, -12.997801130,   58.670458428, -30.027765004], 
            [ 258.089689207, -13.756218083, 258.122297915, -13.760042433,   56.509172184, -31.709195610], 
            [ 260.282306292, -14.490808753, 260.330074148, -14.495822065,   54.290225674, -33.342817059], 
            [ 262.506652373, -15.200437645, 262.570335014, -15.206016178,   53.034922258, -34.568211107], 
            [ 264.688238308, -15.879702302, 264.768200109, -15.885086418,   50.714431389, -36.106475613], 
            [ 266.862421792, -16.530008130, 266.958748026, -16.534473621,   48.322357086, -37.589465106], 
            [ 269.028022489, -17.150797049, 269.140789076, -17.153677301,   45.861904622, -39.012095901], 
            [ 271.221046175, -17.742384260, 271.350281242, -17.742927842,   44.445975213, -40.056569022], 
            [ 273.364055013, -18.302686259, 273.509358971, -18.300227443,   41.872506901, -41.362877019], 
            [ 275.493159996, -18.832806147, 275.653913733, -18.826868419,   39.231345987, -42.600234927], 
            [ 277.607198765, -19.332835573, 277.782927452, -19.323091021,   36.522836810, -43.766186044], 
            [ 279.743250414, -19.802114949, 279.933525100, -19.788227544,   34.955655385, -44.601142048], 
            [ 281.826246995, -20.242003059, 282.030487036, -20.223832108,   32.140127655, -45.635959868], 
            [ 283.894285968, -20.652223445, 284.112060290, -20.629811961,   29.259492950, -46.594069986], 
            [ 285.947549296, -21.032891290, 286.178724769, -21.006278016,   26.321030649, -47.472541411], 
            [ 288.022519971, -21.381619103, 288.267176796, -21.350679164,   24.618956258, -48.083678919], 
            [ 290.044869266, -21.703433939, 290.303123035, -21.668162254,   21.585698100, -48.821178499], 
            [ 292.050749699, -21.996616535, 292.322942991, -21.956933620,   18.504986536, -49.475243231], 
            [ 294.039244982, -22.261746610, 294.325970737, -22.217392734,   15.384773846, -50.044729067]
        ];

        testPlanet(plutoData, 10);
    });


    describe('Stars', function() {
        it('Vega', function() {
            return;
            const timeParameters : TimeParametersInfo = TimeParameters.createFromJulianSpan(
                2450497.5000000, 2450520, 22.5, TimeConvention.TIME_UTC
            );
            const corrections : CorrectionInfo = {
                corrections : [CorrectionType.LIGHT_TIME],
                refractionParams : {refractionModel : RefractionModel.NO_CORRECTION}
            };
            const earthPos : EarthPosition = {lat : 61.4945763, lon : 23.8283, h : 121.916};
            const dummyTimeStamp : TimeStamp = new TimeStamp(
                TimeFormat.FORMAT_JULIAN, 
                TimeConvention.TIME_TDB,
                2458849.5000000);
    
            const observer : ObserverInfo = Observer.initializeFromWgs84(earthPos, dummyTimeStamp);


            
            const target : Target = targetList[<number> targetMap.get("3 Alpha Lyrae (Vega)_HIP")];
            const targetSel : Target[] = [target];

            const computationInfo : ComputationInfo = {
                timeParameters : timeParameters,
                corrections : corrections,
                observer : observer,
                targetList : targetSel
            };

            const computation : Computation = new Computation(computationInfo);
            const results : TimeStepResults[] = computation.compute();

            for (let timeStep = 0; timeStep < results.length; timeStep++) {
                const timeStepResults : TimeStepResults = results[timeStep];
                console.log(timeStepResults);
                
                for (let indTarget = 0; indTarget < timeStepResults.targets.length; indTarget++) {
                    console.log(timeStepResults.results[indTarget].stateMapRaw
                        .get(FrameCenter.HELIOCENTER)
                        ?.get(FrameOrientation.J2000_EQ));
                    console.log(timeStepResults.results[indTarget].stateMapRaw
                        .get(FrameCenter.PLANET_TOPO)
                        ?.get(FrameOrientation.ENU));
                    /*
                    console.log("light-time");
                    console.log(timeStepResults.results[indTarget].stateMapLightTime
                        .get(FrameCenter.PLANET_TOPO)
                        ?.get(FrameOrientation.ENU));
                    console.log("aberrationcla");
                    console.log(timeStepResults.results[indTarget].stateMapAberrationCla
                        .get(FrameCenter.PLANET_TOPO)
                        ?.get(FrameOrientation.ENU));
                    console.log(timeStepResults.results[indTarget].stateMapAberrationRel
                        .get(FrameCenter.PLANET_TOPO)
                        ?.get(FrameOrientation.ENU));
                    console.log(timeStepResults.results[indTarget].stateMapAberrationRel
                        .get(FrameCenter.PLANET_TOPO)
                        ?.get(FrameOrientation.J2000_EQ));
                    console.log(timeStepResults.results[indTarget].stateMapLightTime
                        .get(FrameCenter.BODY_CENTER)
                        ?.get(FrameOrientation.J2000_EQ));
                    console.log(timeStepResults.results[indTarget].stateMapAberrationCla
                        .get(FrameCenter.BODY_CENTER)
                        ?.get(FrameOrientation.J2000_EQ));
                    console.log("fooo");
                    console.log(timeStepResults.results[indTarget].stateMapLightTime
                        .get(FrameCenter.BODY_CENTER)
                        ?.get(FrameOrientation.J2000_EQ)); */
                }
            }
        });
    });
});
});